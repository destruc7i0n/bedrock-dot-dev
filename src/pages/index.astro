---
import DocSearch from "@components/docsearch/docsearch.astro";
import Footer from "@components/footer.astro";
import Navbar from "@components/homepage/navbar.astro";
import VersionChooser from "@components/version-chooser/version-chooser";
import Layout from "@layouts/layout.astro";

import { algolia } from "@lib/constants/algolia";
import { Locale, t } from "@lib/i18n";
import { getTags } from "@lib/tags";
import { allFilesList } from "@lib/versions/list";
import { compressVersions } from "@lib/versions/transform";

const versions = await allFilesList(Locale.English);

// compress versions to reduce the size in the initial payload
const compressedVersions = compressVersions(versions);

const tags = await getTags(Locale.English);
---

<Layout title="bedrock.dev" description={t("page.home.website_description")}>
  <Fragment slot="head">
    <link
      rel="preconnect"
      href={`https://${algolia.appId}-dsn.algolia.net`}
      crossorigin
    />
  </Fragment>

  <div
    class="border-b border-gray-200 bg-gray-50 dark:border-dark-gray-800 dark:bg-dark-gray-950"
  >
    <Navbar />

    <div
      class="mx-auto flex max-w-screen-sm flex-wrap px-4 py-10 text-center sm:px-6 md:px-8"
    >
      <h1
        class="w-full text-4xl font-extrabold leading-10 text-gray-900 dark:text-white md:text-5xl"
      >
        bedrock.dev
      </h1>
      <h2
        class="mb-6 mt-4 w-full text-center text-xl font-medium leading-tight text-gray-900 dark:text-gray-200 sm:mt-5 md:text-2xl"
      >
        {t("page.home.subtitle")}
      </h2>

      <DocSearch
        placeHolder={t("page.home.search_placeholder")}
        size="lg"
        locale={Locale.English}
      />
    </div>
  </div>

  <div class="mx-auto mt-10 max-w-screen-sm px-4 sm:px-6 md:px-8">
    <div
      class="w-full appearance-none rounded-lg bg-white text-black outline-none transition duration-150 ease-in-out dark:bg-dark-gray-950 dark:text-gray-200"
    >
      <div class="flex flex-wrap p-3 text-xl font-normal xl:items-center">
        <h2 class="w-full pb-3 text-xl font-bold">
          {t("component.version_chooser.title")}
        </h2>

        <VersionChooser
          client:load
          compressedVersions={compressedVersions}
          tags={tags}
        />
      </div>
    </div>

    <div class="mt-6">
      <Footer outline={false} />
    </div>
  </div>
</Layout>
